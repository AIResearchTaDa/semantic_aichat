# ============================================================================
# TA-DA! SEMANTIC SEARCH v2.1 - CONFIGURATION TEMPLATE
# ============================================================================
# –í–ê–ñ–õ–ò–í–û: –°–∫–æ–ø—ñ—é–π—Ç–µ —Ü–µ–π —Ñ–∞–π–ª –≤ .env —Ç–∞ –∑–∞–º—ñ–Ω—ñ—Ç—å –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–∏ —Ä–µ–∞–ª—å–Ω–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏
# cp .env.example .env
# ============================================================================

# ============ ELASTICSEARCH & EMBEDDINGS ============

# Elasticsearch Connection
ELASTIC_URL=http://elasticsearch-qwen3:9200
ELASTIC_USER=elastic
ELASTIC_PASSWORD=your_elastic_password_here

# Embedding Service (Qwen3-8B on Ollama)
EMBEDDING_API_URL=http://10.2.0.171:9001/api/embeddings
OLLAMA_MODEL_NAME=dengcao/Qwen3-Embedding-8B:Q8_0

# Index Configuration
INDEX_NAME=products_qwen3_8b
VECTOR_DIMENSION=4096
VECTOR_FIELD_NAME=description_vector

# ============ CACHE & PERFORMANCE ============

# Embedding Cache
EMBED_CACHE_SIZE=2000
CACHE_TTL_SECONDS=3600

# Network Timeouts
REQUEST_TIMEOUT=40
MAX_RETRIES=3

# Embedding Concurrency
# üî¥ –ó–ú–Ü–ù–ï–ù–û: 3 ‚Üí 2 (–ö–†–ò–¢–ò–ß–ù–û –¥–ª—è —Å—Ç–∞–±—ñ–ª—å–Ω–æ—Å—Ç—ñ Ollama API!)
EMBEDDING_MAX_CONCURRENT=2
# üÜï –ù–û–í–ò–ô –ø–∞—Ä–∞–º–µ—Ç—Ä –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—é timeout –æ–¥–Ω–æ–≥–æ embedding –∑–∞–ø–∏—Ç—É
EMBEDDING_SINGLE_TIMEOUT=20.0

# Background Tasks
# üÜï –ù–û–í–ò–ô –ø–∞—Ä–∞–º–µ—Ç—Ä –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –æ—á–∏—â–µ–Ω–Ω—è –∫–µ—à—ñ–≤
CLEANUP_INTERVAL_SECONDS=300

# ============ SEARCH PARAMETERS ============

# KNN Search
KNN_NUM_CANDIDATES=700

# Hybrid Search (weighted fusion)
HYBRID_ALPHA=0.7
HYBRID_FUSION=weighted

# BM25 Full-Text Search
# üî¥ –ó–ú–Ü–ù–ï–ù–û: 10.0 ‚Üí 5.0 –¥–ª—è –ö–†–ê–©–û–ì–û recall (–±—ñ–ª—å—à–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–∏—Ö —Ç–æ–≤–∞—Ä—ñ–≤)
BM25_MIN_SCORE=5.0

# Chat Search Relevance (–∞–¥–∞–ø—Ç–∏–≤–Ω—ñ –ø–æ—Ä–æ–≥–∏)
CHAT_SEARCH_SCORE_THRESHOLD_RATIO=0.35
# üî¥ –ó–ú–Ü–ù–ï–ù–û: 0.3 ‚Üí 0.28 –¥–ª—è –ö–†–ê–©–û–ì–û recall
CHAT_SEARCH_MIN_SCORE_ABSOLUTE=0.28
CHAT_SEARCH_SUBQUERY_WEIGHT_DECAY=0.85
CHAT_SEARCH_MAX_K_PER_SUBQUERY=25

# ============ LAZY LOADING & PAGINATION ============

INITIAL_PRODUCTS_BATCH=20
LOAD_MORE_BATCH_SIZE=20
SEARCH_RESULTS_TTL_SECONDS=3600

# ============ GPT SETTINGS ============

# OpenAI API
# ‚ö†Ô∏è –ó–ê–ú–Ü–ù–Ü–¢–¨ –Ω–∞ –≤–∞—à —Ä–µ–∞–ª—å–Ω–∏–π OpenAI API –∫–ª—é—á!
OPENAI_API_KEY=your_openai_api_key_here
GPT_MODEL=gpt-4o-mini
ENABLE_GPT_CHAT=true
GPT_TEMPERATURE=0.3

# GPT Timeouts
# üî¥ –ó–ú–Ü–ù–ï–ù–û: 10.0 ‚Üí 15.0 –¥–ª—è –°–¢–ê–ë–Ü–õ–¨–ù–û–°–¢–Ü
GPT_ANALYZE_TIMEOUT_SECONDS=15.0
# üî¥ –ó–ú–Ü–ù–ï–ù–û: 20.0 ‚Üí 30.0 –¥–ª—è –°–¢–ê–ë–Ü–õ–¨–ù–û–°–¢–Ü
GPT_RECO_TIMEOUT_SECONDS=30.0

# GPT Token Limits
# üî¥ –ó–ú–Ü–ù–ï–ù–û: 1500 ‚Üí 2000 –¥–ª—è –î–ï–¢–ê–õ–¨–ù–Ü–®–ò–• –ø—Ä–æ–º–ø—Ç—ñ–≤
GPT_MAX_TOKENS_ANALYZE=2000
# üî¥ –ó–ú–Ü–ù–ï–ù–û: 2000 ‚Üí 2500 –¥–ª—è –ë–Ü–õ–¨–®–ï —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π (7-12)
GPT_MAX_TOKENS_RECO=2500

# ============ RECOMMENDATIONS ============

RECO_DETAILED_COUNT=3
GROUNDED_RECOMMENDATIONS=true

# ============ SEARCH HISTORY ============

SEARCH_HISTORY_TTL_DAYS=7
MAX_SEARCH_HISTORY=20
MAX_CHAT_DISPLAY_ITEMS=100

# ============ TA-DA EXTERNAL API ============

TA_DA_API_BASE_URL=https://api.ta-da.net.ua/v1.2/mobile
# ‚ö†Ô∏è –ó–ê–ú–Ü–ù–Ü–¢–¨ –Ω–∞ –≤–∞—à —Ä–µ–∞–ª—å–Ω–∏–π TA-DA API —Ç–æ–∫–µ–Ω!
TA_DA_API_TOKEN=your_ta_da_api_token_here
TA_DA_DEFAULT_SHOP_ID=8
TA_DA_DEFAULT_LANGUAGE=ua

# ============================================================================
# üìã SUMMARY OF CHANGES v2.0 ‚Üí v2.1:
# ============================================================================
# üî¥ CRITICAL CHANGES:
#   - EMBEDDING_MAX_CONCURRENT: 3 ‚Üí 2 (—Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å Ollama)
#   - BM25_MIN_SCORE: 10.0 ‚Üí 5.0 (–∫—Ä–∞—â–∏–π recall)
#   - GPT_ANALYZE_TIMEOUT: 10.0 ‚Üí 15.0 (—Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å)
#   - GPT_RECO_TIMEOUT: 20.0 ‚Üí 30.0 (—Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å)
#   - GPT_MAX_TOKENS_ANALYZE: 1500 ‚Üí 2000 (–¥–µ—Ç–∞–ª—å–Ω—ñ –ø—Ä–æ–º–ø—Ç–∏)
#   - GPT_MAX_TOKENS_RECO: 2000 ‚Üí 2500 (–±—ñ–ª—å—à–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π)
#   - CHAT_SEARCH_MIN_SCORE: 0.3 ‚Üí 0.28 (–∫—Ä–∞—â–∏–π recall)
#
# üÜï NEW PARAMETERS:
#   - EMBEDDING_SINGLE_TIMEOUT=20.0 (–∫–æ–Ω—Ç—Ä–æ–ª—å timeout)
#   - CLEANUP_INTERVAL_SECONDS=300 (–∞–≤—Ç–æ–æ—á–∏—â–µ–Ω–Ω—è)
#   - ELASTIC_USER + ELASTIC_PASSWORD (–∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è)
#
# üìà IMPROVEMENTS:
#   - –ö—Ä–∞—â–∏–π recall (–±—ñ–ª—å—à–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–∏—Ö —Ç–æ–≤–∞—Ä—ñ–≤)
#   - –°—Ç–∞–±—ñ–ª—å–Ω—ñ—à–∞ —Ä–æ–±–æ—Ç–∞ GPT
#   - –î–µ—Ç–∞–ª—å–Ω—ñ—à—ñ —Ç–∞ —Ä–æ–∑—É–º–Ω—ñ—à—ñ –ø—Ä–æ–º–ø—Ç–∏
#   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ—á–∏—â–µ–Ω–Ω—è –∫–µ—à—ñ–≤
#   - –Ü—î—Ä–∞—Ä—Ö—ñ—á–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ–π –∑ –µ–º–æ–¥–∑—ñ
#
# üîê SECURITY:
#   - –ù–ï –∫–æ–º–º—ñ—Ç—å—Ç–µ .env –≤ git!
#   - –î–æ–¥–∞–π—Ç–µ .env –≤ .gitignore
#   - –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ secrets manager –≤ production
# ============================================================================

# ============================================================================
# üöÄ QUICK START:
# ============================================================================
# 1. –°–∫–æ–ø—ñ—é–π—Ç–µ —Ü–µ–π —Ñ–∞–π–ª:
#    cp .env.example .env
#
# 2. –ó–∞–º—ñ–Ω—ñ—Ç—å –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–∏:
#    - your_openai_api_key_here ‚Üí –≤–∞—à OpenAI API –∫–ª—é—á
#    - your_ta_da_api_token_here ‚Üí –≤–∞—à TA-DA API —Ç–æ–∫–µ–Ω
#    - your_elastic_password_here ‚Üí –≤–∞—à Elasticsearch –ø–∞—Ä–æ–ª—å
#
# 3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:
#    - EMBEDDING_API_URL –≤–∫–∞–∑—É—î –Ω–∞ –≤–∞—à Ollama —Å–µ—Ä–≤–µ—Ä
#    - ELASTIC_URL –≤–∫–∞–∑—É—î –Ω–∞ –≤–∞—à Elasticsearch
#
# 4. –ó–∞–ø—É—Å—Ç—ñ—Ç—å —Å–∏—Å—Ç–µ–º—É:
#    python main.py
# ============================================================================